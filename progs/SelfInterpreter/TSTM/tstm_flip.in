'(
(program.((invol.(TSTM.((pair.((variable.Start).(pair.((variable.End).(pair.((variable.Rules).(variable.S_right))))))).((assign.(Xor.(S_right'.(variable.S_right)))).((replacement.((pair.((variable.Start).(pair.((variable.End).(pair.((variable.Rules).(variable.S_right'))))))).(callS.(RTM.(pair.((variable.Start).(pair.((variable.End).(pair.((variable.Rules).(variable.S_right'))))))))))).((replacement.((pair.((variable.S_right).(variable.S_right'))).(pair.((variable.S_right').(variable.S_right))))).nil)))))).(nil.((proc.(RTM.((pair.((variable.Start).(pair.((variable.End).(pair.((variable.Rules).(variable.S_right))))))).(((replacement.((variable.S).(constant.blank))).((assign.(Xor.(Q.(variable.Start)))).((loopS.((operation.(Eq.((variable.Q).(variable.Start)))).(((skipS.nil).nil).(((replacement.((pair.((variable.R).(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))).(callS.(takeRule.(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))))).((replacement.((pair.((variable.Q).(pair.((variable.R).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))).(callS.(step.(pair.((variable.Q).(pair.((variable.R).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))))))).((replacement.((pair.((variable.S).(pair.((variable.Q).(variable.Rules))))).(callS.(putRule.(pair.((variable.R).(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))))))).nil))).(operation.(Eq.((variable.Q).(variable.End)))))))).((assign.(Xor.(Q.(variable.End)))).((replacement.((constant.blank).(variable.S))).nil))))).(pair.((variable.Start).(pair.((variable.End).(pair.((variable.Rules).(variable.S_right))))))))))).((proc.(takeRule.((pair.((variable.S).(pair.((variable.Q).(variable.Rules))))).(((replacement.((pair.((pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))).(variable.Rules))).(variable.Rules))).((conditional.((operation.(And.((operation.(Eq.((variable.Q1).(variable.Q)))).(operation.(Or.((operation.(Eq.((variable.S1).(constant.move)))).(operation.(Eq.((variable.S1).(variable.S)))))))))).(((replacement.((variable.R').(pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))))).((assign.(Xor.(R.(variable.R')))).nil)).(((replacement.((variable.R').(pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))))).((replacement.((pair.((variable.R).(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))).(callS.(takeRule.(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))))).nil)).(operation.(Eq.((variable.R).(variable.R')))))))).((replacement.((variable.Rules).(pair.((variable.R').(variable.Rules))))).nil))).(pair.((variable.R).(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))))))).((proc.(step.((pair.((variable.Q).(pair.((variable.R).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))).(((replacement.((pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))).(variable.R))).((assign.(Xor.(Q.(variable.Q1)))).((assign.(Xor.(Q.(variable.Q2)))).((conditional.((operation.(Eq.((variable.S1).(constant.move)))).(((replacement.((pair.((variable.S2).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))).(callS.(move.(pair.((variable.S2).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))))).nil).(((assign.(Xor.(S.(variable.S1)))).((assign.(Xor.(S.(variable.S2)))).nil)).(operation.(Eq.((variable.S1).(constant.move)))))))).((replacement.((variable.R).(pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))))).nil))))).(pair.((variable.Q).(pair.((variable.R).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))))))).((proc.(putRule.((pair.((variable.R).(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))).(((replacement.((pair.((pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))).(variable.Rules))).(variable.Rules))).((conditional.((operation.(And.((operation.(Eq.((variable.Q2).(variable.Q)))).(operation.(Or.((operation.(Eq.((variable.S1).(constant.move)))).(operation.(Eq.((variable.S2).(variable.S)))))))))).(((replacement.((variable.R').(pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))))).((assign.(Xor.(R.(variable.R')))).((replacement.((pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))).(variable.R'))).nil))).(((replacement.((pair.((variable.S).(pair.((variable.Q).(variable.Rules))))).(callS.(putRule.(pair.((variable.R).(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))))))).nil).(operation.(And.((operation.(Eq.((variable.Q2).(variable.Q)))).(operation.(Or.((operation.(Eq.((variable.S1).(constant.move)))).(operation.(Eq.((variable.S2).(variable.S)))))))))))))).((replacement.((variable.Rules).(pair.((pair.((variable.Q1).(pair.((variable.S1).(pair.((variable.S2).(variable.Q2))))))).(variable.Rules))))).nil))).(pair.((variable.S).(pair.((variable.Q).(variable.Rules))))))))).((proc.(move.((pair.((variable.D).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))).(((conditional.((operation.(Eq.((variable.D).(constant.down)))).(((skipS.nil).nil).(((conditional.((operation.(Eq.((variable.D).(constant.left)))).(((replacement.((pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))).(callS.(left.(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))).nil).(((replacement.((pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))).(uncallS.(left.(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))).nil).(operation.(Eq.((variable.D).(constant.left)))))))).nil).(operation.(Eq.((variable.D).(constant.down)))))))).nil).(pair.((variable.D).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))))).((proc.(left.((pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))).(((conditional.((operation.(And.((operation.(Eq.((variable.S_right).(constant.nil)))).(operation.(Eq.((variable.S).(constant.blank))))))).(((assign.(Xor.(S.(constant.blank)))).nil).(((replacement.((variable.S_right).(pair.((variable.S).(variable.S_right))))).nil).(operation.(Eq.((variable.S_right).(constant.nil)))))))).((conditional.((operation.(Eq.((variable.S_left).(constant.nil)))).(((assign.(Xor.(S.(constant.blank)))).nil).(((replacement.((pair.((variable.S).(variable.S_left))).(variable.S_left))).nil).(operation.(And.((operation.(Eq.((variable.S_left).(constant.nil)))).(operation.(Eq.((variable.S).(constant.blank))))))))))).nil)).(pair.((variable.S_left).(pair.((variable.S).(variable.S_right))))))))).nil)))))))))
.
(start.(end.(
((start.(move.(right.q1))).
((q1.(1.(0.q2))).
((q1.(0.(1.q2))).
((q2.(move.(left.end))).
nil)))).
(1.(0.(1.nil))) //tape
)))

)